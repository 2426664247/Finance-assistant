<<<<<<< HEAD
# Financial-Assistant: æ‚¨çš„ä¸ªäººæ™ºèƒ½é‡‘èåŠ©æ‰‹

Financial-Assistant æ˜¯ä¸€ä¸ªåŸºäºå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ„å»ºçš„æ™ºèƒ½é‡‘èå¯¹è¯åŠ©æ‰‹ã€‚å®ƒç»“åˆäº†å…ˆè¿›çš„è‡ªç„¶è¯­è¨€å¤„ç†èƒ½åŠ›å’Œå®æ—¶çš„é‡‘èæ•°æ®åˆ†æå·¥å…·ï¼Œæ—¨åœ¨ä¸ºç”¨æˆ·æä¾›ä¸“ä¸šã€ä¾¿æ·çš„é‡‘èä¿¡æ¯æŸ¥è¯¢å’Œåˆ†ææœåŠ¡ã€‚

## æ ¸å¿ƒåŠŸèƒ½

- **å¤šè½®å¯¹è¯**ï¼šæ”¯æŒæµç•…ã€æœ‰ä¸Šä¸‹æ–‡è®°å¿†çš„å¤šè½®å¯¹è¯ï¼Œèƒ½å¤Ÿæ·±å…¥ç†è§£ç”¨æˆ·æ„å›¾ã€‚
- **é‡‘èæ•°æ®åˆ†æ**ï¼šé›†æˆ Tushare å’Œ yfinance æ•°æ®æ¥å£ï¼Œå¯å®æ—¶æŸ¥è¯¢å’Œåˆ†æè‚¡ç¥¨è¡Œæƒ…ã€è´¢åŠ¡æ•°æ®ç­‰ã€‚
- **çŸ¥è¯†åº“é—®ç­”**ï¼šå†…ç½®é‡‘èçŸ¥è¯†åº“ï¼Œèƒ½å¤Ÿè§£ç­”ä¸“ä¸šçš„é‡‘èæ¦‚å¿µå’Œå¸‚åœºé—®é¢˜ã€‚
- **æ™ºèƒ½å†å²è®°å½•**ï¼š
    - **åŠ¨æ€å‘½å**ï¼šå¯¹è¯ç»“æŸåï¼Œåå°è‡ªåŠ¨è°ƒç”¨è½»é‡ LLM ä¸ºå¯¹è¯ç”Ÿæˆç²¾å‡†æ ‡é¢˜ï¼Œä¼˜åŒ–æŸ¥é˜…ä½“éªŒã€‚
    - **ä¾¿æ·ç®¡ç†**ï¼šæ”¯æŒåœ¨ç•Œé¢ä¸Šç›´æ¥åˆ é™¤å†å²å¯¹è¯è®°å½•ã€‚
- **æ—¶é—´æ„ŸçŸ¥**ï¼šæ™ºèƒ½ä½“èƒ½å¤Ÿè·å–å¹¶ç†è§£å½“å‰æ—¶é—´ï¼Œä¸ºæä¾›æ—¶æ•ˆæ€§ä¿¡æ¯æä¾›æ”¯æŒã€‚
- **æ¨¡å‹è°ƒç”¨ç›‘æ§**ï¼šæ‰€æœ‰å¯¹å¤§æ¨¡å‹çš„è°ƒç”¨ï¼ˆä¸»æ¨¡å‹ã€æ ‡é¢˜ç”Ÿæˆæ¨¡å‹ï¼‰éƒ½ä¼šåœ¨ç»ˆç«¯æ‰“å°è¯¦ç»†æ—¥å¿—ï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§ã€‚

## æŠ€æœ¯æ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨åˆ†å±‚æ¶æ„ï¼Œå°†å‰ç«¯å±•ç¤ºã€åç«¯é€»è¾‘å’Œæ ¸å¿ƒæ™ºèƒ½å®Œå…¨è§£è€¦ï¼Œä¿è¯äº†ä»£ç çš„æ¸…æ™°åº¦å’Œå¯ç»´æŠ¤æ€§ã€‚

```
/
â”œâ”€â”€ app.py                  # Streamlit åº”ç”¨ä¸»å…¥å£
â”œâ”€â”€ chat_history/           # å­˜æ”¾èŠå¤©è®°å½•çš„ç›®å½•
â”œâ”€â”€ financial_agent/        # æ™ºèƒ½ä½“æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ configs/
â”‚   â”‚   â””â”€â”€ .env.example    # ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ agent.py        # LangChain Agent çš„å°è£…å’Œå®ç°
â”‚   â”‚   â””â”€â”€ llm_adapter.py  # ç«å±±æ–¹èˆŸ LLM å’Œ Embedding æ¨¡å‹é€‚é…å™¨
â”‚   â”œâ”€â”€ tools/              # Agent å¯ä½¿ç”¨çš„å·¥å…·
â”‚   â”‚   â”œâ”€â”€ financial_data_tool.py # é‡‘èæ•°æ®æŸ¥è¯¢å·¥å…·
â”‚   â”‚   â””â”€â”€ knowledge_base_tool.py # çŸ¥è¯†åº“æ£€ç´¢å·¥å…·
â”‚   â””â”€â”€ requirements.txt    # Python ä¾èµ–é¡¹
â””â”€â”€ webapp/                 # Streamlit å‰ç«¯åº”ç”¨
    â”œâ”€â”€ session.py          # ä¼šè¯çŠ¶æ€ç®¡ç†ï¼ˆåŒ…æ‹¬æ™ºèƒ½å‘½åé€»è¾‘ï¼‰
    â””â”€â”€ ui.py               # UI ç»„ä»¶å’Œå¸ƒå±€
```

### å…³é”®ç»„ä»¶è¯¦è§£

1.  **`llm_adapter.py`**:
    *   **`VolcanoLLM`**: ç»§æ‰¿è‡ª LangChain çš„ `LLM` åŸºç±»ï¼Œé€‚é…ç«å±±å¼•æ“æ–¹èˆŸï¼ˆVolcEngine ARKï¼‰æœåŠ¡ã€‚å®ƒæ”¯æŒåœ¨åˆå§‹åŒ–æ—¶åŠ¨æ€ä¼ å…¥ `model_id`ï¼Œä»è€Œå…è®¸åœ¨ä¸åŒåœºæ™¯ï¼ˆå¦‚ä¸»å¯¹è¯ã€æ ‡é¢˜ç”Ÿæˆï¼‰ä½¿ç”¨ä¸åŒçš„æ¨¡å‹ã€‚
    *   **`VolcanoEmbeddings`**: é€‚é…ç«å±±æ–¹èˆŸçš„ Embedding æ¨¡å‹ï¼Œç”¨äºçŸ¥è¯†åº“çš„æ–‡æœ¬å‘é‡åŒ–ã€‚
    *   **æ—¥å¿—ç³»ç»Ÿ**: åœ¨ `_call` (åŒæ­¥) å’Œ `_stream` (æµå¼) æ–¹æ³•ä¸­é›†æˆäº†è¯¦ç»†çš„æ—¥å¿—è¾“å‡ºï¼Œå°†æ¨¡å‹ ID å’Œè¿”å›å†…å®¹æ‰“å°åˆ°ç»ˆç«¯ï¼Œå®ç°äº†å®Œå…¨çš„è°ƒç”¨é€æ˜åŒ–ã€‚

2.  **`agent.py`**:
    *   åŸºäº LangChain çš„ `ConversationalChatAgent` æ„å»ºï¼Œå®ç°äº†å…·å¤‡å¯¹è¯è®°å¿†çš„ ReAct (Reasoning and Acting) é£æ ¼æ™ºèƒ½ä½“ã€‚
    *   å®ƒèƒ½å¤Ÿæ ¹æ®ç”¨æˆ·é—®é¢˜ï¼Œè‡ªä¸»å†³ç­–å¹¶è°ƒç”¨ `financial_data_tool` æˆ– `knowledge_base_tool` æ¥å®Œæˆä»»åŠ¡ã€‚

3.  **`session.py`**:
    *   **`generate_chat_title`**: å¯¹è¯è¿›è¡Œåˆ°ç¬¬äºŒè½®æ—¶ï¼Œåœ¨åå°çº¿ç¨‹ä¸­è¢«è°ƒç”¨ã€‚å®ƒä¼šè¯·æ±‚ä¸€ä¸ªç‹¬ç«‹çš„ã€è½»é‡çš„ LLMï¼ˆç”± `ARK_TITLE_MODEL_ID` æŒ‡å®šï¼‰ä¸ºå½“å‰å¯¹è¯ç”Ÿæˆä¸€ä¸ªç®€æ´çš„æ ‡é¢˜ï¼Œå¹¶ç¼“å­˜ç»“æœã€‚
    *   **`save_chat_history`**: å½“ç”¨æˆ·ç‚¹å‡»â€œæ–°å¯¹è¯â€æ—¶è§¦å‘ã€‚å®ƒä¼šä¼˜å…ˆä½¿ç”¨ç¼“å­˜ä¸­çš„æ ‡é¢˜æ¥ä¿å­˜èŠå¤©è®°å½•ï¼Œå®ç°äº†â€œé›¶ç­‰å¾…â€çš„æ™ºèƒ½å‘½åä½“éªŒã€‚å¦‚æœç¼“å­˜ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåŒæ­¥è°ƒç”¨æ¨¡å‹ç”Ÿæˆæ ‡é¢˜ã€‚

## æœ¬åœ°éƒ¨ç½²æŒ‡å—

### 1. å…‹éš†ä»“åº“

```bash
git clone https://github.com/your-username/Financial-Assistant.git
cd Financial-Assistant
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ `financial_agent/configs/` ç›®å½•ä¸‹ï¼Œå¤åˆ¶ `.env.example` æ–‡ä»¶å¹¶é‡å‘½åä¸º `.env`ã€‚

```bash
cp financial_agent/configs/.env.example financial_agent/configs/.env
```

ç„¶åï¼Œç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„ä¸ªäººå¯†é’¥å’Œæ¨¡å‹ä¿¡æ¯ã€‚

```ini
# ç«å±±æ–¹èˆŸ API Key (ä»ç«å±±å¼•æ“æ§åˆ¶å°è·å–)
ARK_API_KEY="YOUR_ARK_API_KEY"

# Tushare Token (ä» Tushare å®˜ç½‘ä¸ªäººä¸»é¡µè·å–)
TUSHARE_TOKEN="YOUR_TUSHARE_TOKEN"

# --- æ¨¡å‹ ID é…ç½® ---
# ä¸»å¯¹è¯æ¨¡å‹ (æ¨èä½¿ç”¨æ€§èƒ½å¼ºåŠ²çš„æ¨¡å‹)
ARK_MODEL_ID="ep-20240701185338-5q5f7"

# å†å²è®°å½•æ ‡é¢˜ç”Ÿæˆæ¨¡å‹ (æ¨èä½¿ç”¨å“åº”é€Ÿåº¦å¿«çš„è½»é‡æ¨¡å‹)
ARK_TITLE_MODEL_ID="ep-20251105151025-g4n4m"

# Embedding æ¨¡å‹ (ç”¨äºçŸ¥è¯†åº“å‘é‡åŒ–)
ARK_EMBEDDING_MODEL_ID="embedding-model-id"
```

### 3. å®‰è£…ä¾èµ–

å»ºè®®åœ¨è™šæ‹Ÿç¯å¢ƒä¸­å®‰è£…ï¼Œä»¥é¿å…åŒ…ç‰ˆæœ¬å†²çªã€‚

```bash
python -m venv venv
source venv/bin/activate  # Linux/macOS
# venv\Scripts\activate  # Windows

pip install -r financial_agent/requirements.txt
```

### 4. è¿è¡Œåº”ç”¨
=======
# Financial Agent - æ™ºèƒ½é‡‘èåŠ©æ‰‹

è¿™æ˜¯ä¸€ä¸ªåŸºäºå¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æ„å»ºçš„æ™ºèƒ½é‡‘èåŠ©æ‰‹ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªç„¶è¯­è¨€ä¸å®ƒè¿›è¡Œäº¤äº’ï¼Œè·å–é‡‘èæ•°æ®æŸ¥è¯¢ã€å¸‚åœºåˆ†æã€çŸ¥è¯†é—®ç­”ç­‰æœåŠ¡ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **è‡ªç„¶è¯­è¨€äº¤äº’**ï¼šåƒä¸çœŸäººå¯¹è¯ä¸€æ ·ï¼Œæå‡ºæ‚¨çš„é‡‘èé—®é¢˜ã€‚
- **å®æ—¶é‡‘èæ•°æ®**ï¼šé›†æˆ Tushare å’Œ yfinance æ•°æ®æ¥å£ï¼Œæä¾›è‚¡ç¥¨ã€æŒ‡æ•°ç­‰å®æ—¶å’Œå†å²æ•°æ®æŸ¥è¯¢ã€‚
- **æœ¬åœ°çŸ¥è¯†åº“**ï¼šå†…ç½®é‡‘èçŸ¥è¯†åº“ï¼Œèƒ½å¤Ÿè§£ç­”ä¸“ä¸šçš„é‡‘èæ¦‚å¿µå’Œé—®é¢˜ã€‚
- **å¯æ‰©å±•å·¥å…·é›†**ï¼šåŸºäº LangChain Agent æ¶æ„ï¼Œå¯ä»¥æ–¹ä¾¿åœ°æ‰©å±•æ›´å¤šé‡‘èå·¥å…·ã€‚
- **Web ç•Œé¢**ï¼šä½¿ç”¨ Streamlit æ„å»ºï¼Œæä¾›å‹å¥½çš„ç”¨æˆ·äº¤äº’ç•Œé¢ã€‚

## ğŸš€ ç¯å¢ƒè®¾ç½®ä¸è¿è¡Œ

ä¸ºäº†ä¿è¯é¡¹ç›®çš„ç¨³å®šè¿è¡Œå’Œä¾èµ–éš”ç¦»ï¼Œå¼ºçƒˆå»ºè®®æ‚¨ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒã€‚

### 1. å…‹éš†é¡¹ç›®

```bash
git clone <your-repository-url>
cd <project-directory>
```

### 2. åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

æœ¬é¡¹ç›®æ¨èä½¿ç”¨ Python 3.9 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚

- **Windows**:
  ```bash
  # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
  python -m venv .venv

  # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
  .\.venv\Scripts\Activate.ps1
  ```

- **macOS / Linux**:
  ```bash
  # åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
  python3 -m venv .venv

  # æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
  source .venv/bin/activate
  ```

æ¿€æ´»æˆåŠŸåï¼Œæ‚¨ä¼šçœ‹åˆ°å‘½ä»¤è¡Œæç¤ºç¬¦å‰å‡ºç° `(.venv)` æ ‡è¯†ã€‚

### 3. å®‰è£…é¡¹ç›®ä¾èµ–

æ‰€æœ‰ä¾èµ–é¡¹éƒ½è®°å½•åœ¨ `financial_agent/requirements.txt` æ–‡ä»¶ä¸­ã€‚

```bash
pip install -r financial_agent/requirements.txt
```

### 4. é…ç½®ç¯å¢ƒå˜é‡

é¡¹ç›®éœ€è¦é…ç½®ä¸€äº› API å¯†é’¥æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚è¯·åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º `.env` çš„æ–‡ä»¶ï¼Œå¹¶æ ¹æ® `financial_agent/.env.example` çš„æ ¼å¼å¡«å…¥æ‚¨çš„å¯†é’¥ï¼š

```
# .env

# ç«å±±å¼•æ“å¤§æ¨¡å‹ Access Key
VOLC_ACCESS_KEY="<your-access-key>"
VOLC_SECRET_KEY="<your-secret-key>"

# Tushare æ•°æ®æ¥å£ Token
TUSHARE_TOKEN="<your-tushare-token>"
```

### 5. è¿è¡Œåº”ç”¨

ä¸€åˆ‡å‡†å¤‡å°±ç»ªåï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ Streamlit åº”ç”¨ï¼š
>>>>>>> feature/env-setup-and-fix

```bash
streamlit run app.py
```

<<<<<<< HEAD
åº”ç”¨å¯åŠ¨åï¼Œæµè§ˆå™¨å°†è‡ªåŠ¨æ‰“å¼€ `http://localhost:8501`ï¼Œæ‚¨å³å¯å¼€å§‹ä½¿ç”¨ã€‚
=======
åº”ç”¨å¯åŠ¨åï¼Œæ‚¨ä¼šåœ¨ç»ˆç«¯çœ‹åˆ°æœ¬åœ°è®¿é—®åœ°å€ï¼ˆé€šå¸¸æ˜¯ `http://localhost:8501`ï¼‰ï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å³å¯å¼€å§‹ä½¿ç”¨ã€‚

## é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ app.py                  # Streamlit åº”ç”¨ä¸»å…¥å£
â”œâ”€â”€ financial_agent/        # é‡‘è Agent æ ¸å¿ƒé€»è¾‘
â”‚   â”œâ”€â”€ agent.py            # Agent æ‰§è¡Œå™¨
â”‚   â”œâ”€â”€ knowledge_base.csv  # æœ¬åœ°çŸ¥è¯†åº“æ•°æ®
â”‚   â”œâ”€â”€ knowledge_base_tool.py # çŸ¥è¯†åº“æ£€ç´¢å¼•æ“
â”‚   â”œâ”€â”€ requirements.txt    # é¡¹ç›®ä¾èµ–
â”‚   â””â”€â”€ tools/              # Agent å·¥å…·é›†
â”‚       â”œâ”€â”€ financial_data_tool.py # é‡‘èæ•°æ®æŸ¥è¯¢å·¥å…·
â”‚       â””â”€â”€ ...
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡ï¼ˆéœ€è‡ªè¡Œåˆ›å»ºï¼‰
â”œâ”€â”€ .gitignore              # Git å¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md               # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```
>>>>>>> feature/env-setup-and-fix
